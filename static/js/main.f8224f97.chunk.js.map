{"version":3,"sources":["dataset/index.js","state/util.js","state/CalculatorContext.js","components/NodeTooltip.js","components/Node.js","components/Cluster.js","components/Embodiment.js","components/Overview.js","App.js","index.js"],"names":["ascensionData","require","EMBODIMENT_NAMES","CLUSTERS","root","nodes","rewards","EMBODIMENTS","forEach","embodiment","description","toUpperCase","substring","cluster","name","push","isNodeSelected","node","state","index","isNodeSelectable","clusterAvailable","isClusterAvailable","getNodeId","isClusterComplete","i","length","requirements","points","CalculatorContext","React","createContext","BONUS_REGEX","getBonusPoint","subnode","bonusPoint","match","subnodes","toLowerCase","reducer","type","nodeId","newNodes","newPoints","isNodeDeselectable","prevBonusPoint","clusterNames","split","clusterName","isValidState","CalculatorProvider","children","useReducer","force","entropy","form","inertia","life","dispatch","Provider","value","NodeTooltip","descriptionLines","replace","subnodeDescriptions","subnodeLines","className","map","line","tooltipHtml","ReactDOMServer","renderToStaticMarkup","Node","useContext","nodeInfo","isSelected","isSelectable","selectedSubnode","getSelectedSubnode","handler","subnodeElements","classNames","selected","onClick","data-tip","selectable","Cluster","isAvailable","isComplete","available","complete","Embodiment","clusters","VALUE_MODIFIER_REGEX","categories","header","regex","Overview","modifiers","valueModifiers","textModifiers","addModifier","s","trim","modifier","Number","Object","keys","Math","round","collectModifiers","modifiersByCategory","c","otherModifiers","hasCategory","category","categoryElements","m","App","effect","html","multiline","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"6q5EAAMA,EAAgBC,EAAQ,IAEjBC,EAAmB,CAAC,QAAS,UAAW,OAAQ,UAAW,QAC3DC,EAAW,CAAEC,KAAM,CAAEC,MAAO,GAAIC,QAAS,KACzCC,EAAc,GAE3BL,EAAiBM,SACf,SAACC,GAAD,OACGN,EAASC,KAAKC,MAAMI,GAAc,CACjCC,YAAY,MAAD,OAAQD,EAAW,GAAGE,eAAtB,OAAsCF,EAAWG,UAAU,GAA3D,SAGjBV,EAAiBM,SAAQ,SAACC,GAAD,OAAiBF,EAAYE,GAAc,M,oBAEhDT,G,IAApB,2BAAmC,CAAC,IAA3Ba,EAA0B,QACjCV,EAASU,EAAQC,MAAQD,EACzBN,EAAYM,EAAQJ,YAAYM,KAAKF,I,8BCdhC,SAASG,EAAeC,EAAMC,GACnC,MAAO,UAAGD,EAAKJ,QAAR,YAAmBI,EAAKE,SAAWD,EAAMb,MAG3C,SAASe,EAAiBH,EAAMC,GACrC,GAAoB,QAAhBD,EAAKJ,QAAmB,OAAO,EAEnC,IACMQ,EAAmBC,EADTnB,EAASc,EAAKJ,SACuBK,GACrD,OACGG,GAAkC,GAAdJ,EAAKE,OACzBE,GAAoBL,EAAe,2BAAKC,GAAN,IAAYE,MAAOF,EAAKE,MAAQ,IAAKD,GAQrE,SAASK,EAAUN,GACxB,MAAM,GAAN,OAAUA,EAAKJ,QAAf,YAA0BI,EAAKE,OAO1B,SAASK,EAAkBX,EAASK,GACzC,IAAK,IAAIO,EAAI,EAAGA,EAAIZ,EAAQR,MAAMqB,OAAQD,IACxC,IAAKT,EAAe,CAAEH,QAASA,EAAQC,KAAMK,MAAOM,GAAKP,GAAQ,OAAO,EAG1E,OAAO,EAGF,SAASI,EAAmBT,EAASK,GAC1C,IAAK,IAAIT,KAAcI,EAAQc,aAC7B,GAAIT,EAAMU,OAAOnB,GAAcI,EAAQc,aAAalB,GAAa,OAAO,EAG1E,OAAO,EChCF,IAAMoB,EAAoBC,IAAMC,cAAc,MAE/CC,EAAc,yCAEpB,SAASC,EAAT,GAAqD,IAA5BpB,EAA2B,EAA3BA,QAASM,EAAkB,EAAlBA,MAAOe,EAAW,EAAXA,QACjCjB,EAAOd,EAASU,GAASR,MAAMc,GAEjCgB,EAAa,KACbC,EAAQnB,EAAKP,YAAY0B,MAAMJ,GAInC,OAHgB,GAAZE,GAAkBE,IAAOA,EAAQnB,EAAKoB,SAASH,GAASE,MAAMJ,IAC9DI,IAAOD,EAAaC,EAAM,GAAGE,eAE1BH,EAGT,SAASI,EAAQrB,EAAjB,GAAyC,IAAfsB,EAAc,EAAdA,KAAMvB,EAAQ,EAARA,KACxBwB,EAASlB,EAAUN,GACnBJ,EAAUV,EAASc,EAAKJ,SAExB6B,EAAQ,eAAQxB,EAAMb,OACtBsC,EAAS,eAAQzB,EAAMU,QAEvBO,EAAaF,EAAchB,GAEjC,OAAQuB,GACN,IAAK,SACH,IAAKpB,EAAiBH,EAAMC,GAAQ,MAGpC,GAFAwB,EAASD,GAAUxB,EAAKiB,QAEpBV,EAAkBX,EAAD,YAAC,eAAcK,GAAf,IAAsBb,MAAOqC,KAChD,IAAK,IAAIjC,KAAcI,EAAQP,QAC7BqC,EAAUlC,IAAeI,EAAQP,QAAQG,GAIzC0B,IAAYQ,EAAUR,IAAe,GAEzC,MAEF,IAAK,WACH,IDjCC,SAA4BlB,EAAMC,GACvC,OAAQF,EAAe,2BAAKC,GAAN,IAAYE,MAAOF,EAAKE,MAAQ,IAAKD,GCgClD0B,CAAmB3B,EAAMC,GAAQ,MAEtC,GAAIL,GAAWW,EAAkBX,EAAD,YAAC,eAAcK,GAAf,IAAsBb,MAAOqC,KAC3D,IAAK,IAAIjC,KAAcI,EAAQP,QAC7BqC,EAAUlC,IAAeI,EAAQP,QAAQG,GAIzC0B,IAAYQ,EAAUR,IAAe,UAElCO,EAASD,GAChB,MAEF,IAAK,WACH,IAAMI,EAAiBZ,EAAc,2BAAKhB,GAAN,IAAYiB,QAAShB,EAAMb,MAAMoC,MACjEN,IAAYQ,EAAUR,IAAe,GACrCU,IAAgBF,EAAUE,IAAmB,GAEjDH,EAASD,GAAUxB,EAAKiB,QAI5B,OD3BK,YAA0C,IAAlB7B,EAAiB,EAAjBA,MAAOuB,EAAU,EAAVA,OAChCkB,EAAe,GACnB,IAAK,IAAIL,KAAUpC,EACjByC,EAAaL,EAAOM,MAAM,KAAK,KAAM,EAGvC,IAAK,IAAIC,KAAeF,EAAc,CACpC,IAAMjC,EAAUV,EAAS6C,GACzB,IAAK,IAAIvC,KAAcI,EAAQc,aAC7B,GAAIC,EAAOnB,GAAcI,EAAQc,aAAalB,GAC5C,OAAO,EAKb,OAAO,ECYFwC,CAAa,CAAE5C,MAAOqC,EAAUd,OAAQe,IACtC,CAAEtC,MAAOqC,EAAUd,OAAQe,GADgCzB,EAI7D,SAASgC,EAAT,GAA2C,IAAbC,EAAY,EAAZA,SAAY,EACrBC,qBAAWb,EAAS,CAC5ClC,MAAO,GACPuB,OAAQ,CACNyB,MAAO,EACPC,QAAS,EACTC,KAAM,EACNC,QAAS,EACTC,KAAM,KARqC,mBACxCvC,EADwC,KACjCwC,EADiC,KAY/C,OACE,kBAAC7B,EAAkB8B,SAAnB,CAA4BC,MAAO,CAAE1C,QAAOwC,aAAaP,G,oCCrFtD,SAASU,EAAT,GAA0C,IAAnBhD,EAAkB,EAAlBA,QAASM,EAAS,EAATA,MAC/BF,EAAOd,EAASU,GAASR,MAAMc,GAC/BkB,EAAWpB,EAAKoB,SAEhByB,EAAmB7C,EAAKP,YAAYqD,QAAQ,QAAM,IAAIhB,MAAM,MAC5DiB,EAAsB,GAE5B,GAAI3B,GAAYA,EAASX,OACvB,IAAK,IAAID,EAAI,EAAGA,EAAIY,EAASX,OAAQD,IAAK,CACxC,IAAMwC,EAAe5B,EAASZ,GAAGsC,QAAQ,QAAM,IAAIhB,MAAM,MAEzDiB,EAAoBjD,KAClB,yBAAKmD,UAAU,uBACb,0BAAMA,UAAU,kBAAkBzC,EAAI,EAAtC,KACA,0BAAMyC,UAAU,iBACbD,EAAaE,KAAI,SAACC,GAAD,OAChB,0BAAMF,UAAU,oBAAoBE,SAQhD,OACE,6BACE,yBAAKF,UAAU,oBACZJ,EAAiBK,KAAI,SAACC,GAAD,OACpB,0BAAMF,UAAU,oBAAoBE,OAGvCJ,GAKA,SAASK,EAAT,GAA0C,IAAnBxD,EAAkB,EAAlBA,QAASM,EAAS,EAATA,MACrC,OAAOmD,IAAeC,qBAAqB,kBAACV,EAAD,CAAahD,QAASA,EAASM,MAAOA,KClC5E,SAASqD,EAAT,GAAmC,IAAnB3D,EAAkB,EAAlBA,QAASM,EAAS,EAATA,MAAS,EACXsD,qBAAW5C,GAA/BX,EAD+B,EAC/BA,MAAOwC,EADwB,EACxBA,SAETgB,EAAW,CAAE7D,UAASM,SACtBwD,EAAa3D,EAAe0D,EAAUxD,GACtC0D,GAAgBD,GAAcvD,EAAiBsD,EAAUxD,GACzD2D,EAAkBF,GHYnB,SAA4B1D,EAAMC,GACvC,OAAOA,EAAMb,MAAMkB,EAAUN,IGbS6D,CAAmBJ,EAAUxD,GAE7DD,EAAOd,EAASU,GAASR,MAAMc,GAErC,SAAS4D,EAAQ7C,GAObwB,EANGiB,EAKMzC,GAAW2C,EACX,CACPrC,KAAM,WACNvB,KAAK,aAAGiB,WAAYwC,IAGb,CACPlC,KAAM,WACNvB,KAAK,aAAGiB,WAAYwC,IAZb,CACPlC,KAAM,SACNvB,KAAK,aAAGiB,WAAYwC,KAe1B,GAAIzD,EAAKoB,UAAYpB,EAAKoB,SAASX,OAAQ,CAEzC,IADA,IAAMsD,EAAkB,GADiB,WAEhCvD,GACPuD,EAAgBjE,KACd,yBACEmD,UAAWe,IAAW,UAAW,CAAEC,SAAUP,GAAcE,GAAmBpD,IAC9E0D,QAAS,kBAAMJ,EAAQtD,KAEtBA,EAAI,KANFA,EAAI,EAAGA,EAAIR,EAAKoB,SAASX,OAAQD,IAAM,EAAvCA,GAWT,OACE,yBACE2D,WAAUf,EAAYK,GACtBR,UAAWe,IAAW,gBAAiB,CAAEC,SAAUP,EAAYU,WAAYT,KAE1EI,GAIL,OACE,yBACEI,WAAUf,EAAYK,GACtBR,UAAWe,IAAW,OAAQ,CAAEC,SAAUP,EAAYU,WAAYT,IAClEO,QAAS,kBAAMJ,GAAS,MCvDzB,SAASO,EAAT,GAA4B,IAATxE,EAAQ,EAARA,KAChBI,EAAUuD,qBAAW5C,GAArBX,MAEFL,EAAUV,EAASW,GACnByE,EAAcjE,EAAmBT,EAASK,GAC1CsE,EAAaD,GAAe/D,EAAkBX,EAASK,GAEvDS,EAAe,GACrB,IAAK,IAAIlB,KAAcI,EAAQc,aAC7BA,EAAaZ,KACX,yBAAKmD,UAAS,gBAAWzD,IAAeI,EAAQc,aAAalB,KAIjE,IAAMH,EAAU,GAChB,IAAK,IAAIG,KAAcI,EAAQP,QAC7BA,EAAQS,KAAK,yBAAKmD,UAAS,gBAAWzD,IAAeI,EAAQP,QAAQG,KAIvE,IADA,IAAMJ,EAAQ,GACLoB,EAAI,EAAGA,EAAIZ,EAAQR,MAAMqB,OAAQD,IACxCpB,EAAMU,KAAK,kBAACyD,EAAD,CAAM3D,QAASC,EAAMK,MAAOM,KAGzC,OACE,yBAAKyC,UAAWe,IAAW,UAAW,CAAEQ,UAAWF,EAAaG,SAAUF,KACxE,yBAAKtB,UAAU,uBAAuBvC,GACtC,yBAAKuC,UAAU,gBAAf,IAAgCpD,EAAhC,KACA,yBAAKoD,UAAU,kBAAkB5D,GACjC,yBAAK4D,UAAU,SAAS7D,IC/BvB,SAASsF,EAAT,GAA+B,IAAD,EAAR7E,EAAQ,EAARA,KACrB8E,EAAW,GACXnF,EAAaF,EAAYO,GAFI,cAIfL,GAJe,IAInC,2BAAgC,CAAC,IAAxBI,EAAuB,QAC9B+E,EAAS7E,KAAK,kBAACuE,EAAD,CAASxE,KAAMD,EAAQC,SALJ,8BAQnC,OACE,yBAAKoD,UAAU,cACb,yBAAKA,UAAU,mBACZpD,EACD,kBAAC0D,EAAD,CAAM3D,QAAQ,OAAOM,MAAOL,KAE9B,yBAAKoD,UAAU,YAAY0B,ICfjC,IAAMC,EAAuB,kBAEvBC,EAAa,CACjB,CACEC,OAAQ,aACRC,MAAO,2EAET,CACED,OAAQ,SACRC,MAAO,qMAET,CACED,OAAQ,QACRC,MAAO,qHAET,CACED,OAAQ,cACRC,MAAO,mGAET,CACED,OAAQ,UACRC,MAAO,mCAET,CACED,OAAQ,cACRC,MAAO,8CAET,CACED,OAAQ,WACRC,MAAO,YAET,CACED,OAAQ,WACRC,MAAO,YAET,CACED,OAAQ,eACRC,MAAO,iBAkDJ,SAASC,IAAY,IAAD,EACjB/E,EAAUuD,qBAAW5C,GAArBX,MAEFU,EAAS,GAHU,cAIF1B,GAJE,IAIzB,2BAAyC,CAAC,IAAjCO,EAAgC,QACvCmB,EAAOb,KAAK,yBAAKmD,UAAS,gBAAWzD,IAAeS,EAAMU,OAAOnB,MAL1C,8BAQzB,IARyB,EAQnByF,EAtDR,SAA0BhF,GACxB,IAAMiF,EAAiB,GACjBC,EAAgB,GAEtB,SAASC,EAAYjC,GACnBA,EACGrB,MAAM,WACNoB,KAAI,SAACmC,GAAD,OAAOA,EAAEC,UACb/F,SAAQ,SAACgG,GACR,IAAIpE,EAAQoE,EAASpE,MAAMyD,GAC3B,GAAIzD,EAAO,CACT,IAAM1B,EAAc0B,EAAM,GACpBwB,EAAQ6C,OAAOrE,EAAM,IAC3B+D,EAAezF,IAAgByF,EAAezF,IAAgB,GAAKkD,OAEnEwC,EAAcrF,KAAKyF,MAK3B,IAAK,IAAI/D,KAAUvB,EAAMb,MAAO,CAAC,IAAD,EACPoC,EAAOM,MAAM,KADN,mBACzBlC,EADyB,KAChBM,EADgB,KAGxBF,EAAOd,EAASU,GAASR,MAAMc,GAC/Be,EAAUhB,EAAMb,MAAMoC,GAEtB+D,EAAWvF,EAAKP,YAAY6F,OAE9BC,GAAUH,EAAYG,IACV,GAAZtE,GACFmE,EAAYpF,EAAKoB,SAASH,IAM9B,IAFA,IAAMgE,EAAY,GAElB,MAAwBQ,OAAOC,KAAKR,GAApC,eAAqD,CAAhD,IAAIzF,EAAW,KACdkD,EAAQuC,EAAezF,GAC3BwF,EAAUnF,KAAV,WAAmB6F,KAAKC,MAAc,GAARjD,GAAc,IAA5C,OAAiDlD,IAKnD,OAFAwF,EAAUnF,KAAV,MAAAmF,EAAkBE,GAEXF,EAWWY,CAAiB5F,GAC/B6F,EAAsBjB,EAAW3B,KAAI,SAAC6C,GAAD,MAAO,MAC1CC,EAAiB,GAVE,cAYJf,GAZI,IAYzB,2BAAgC,CAG9B,IAH+B,IAAxBM,EAAuB,QAC1BU,GAAc,EAETzF,EAAI,EAAGA,EAAIqE,EAAWpE,OAAQD,IAAK,CAC1C,IAAM0F,EAAWrB,EAAWrE,GAE5B,GAAI+E,EAASlE,cAAcF,MAAM+E,EAASnB,OAAQ,CAChDkB,GAAc,EACdH,EAAoBtF,GAAGV,KAAKyF,GAC5B,OAICU,GACHD,EAAelG,KAAKyF,IA1BC,8BA+BzB,IADA,IAAMY,EAAmB,GAChB3F,EAAI,EAAGA,EAAIqE,EAAWpE,OAAQD,IAAK,CAC1C,IAAM0F,EAAWrB,EAAWrE,GAExBsF,EAAoBtF,GAAGC,QACzB0F,EAAiBrG,KACf,yBAAKmD,UAAU,YACb,yBAAKA,UAAU,mBAAmBiD,EAASpB,OAA3C,KACCgB,EAAoBtF,GAAG0C,KAAI,SAACkD,GAAD,OAC1B,6BAAMA,QAkBhB,OAXIJ,EAAevF,QACjB0F,EAAiBrG,KACf,yBAAKmD,UAAU,YACb,yBAAKA,UAAU,mBAAf,kBACC+C,EAAe9C,KAAI,SAACkD,GAAD,OAClB,6BAAMA,QAOZ,yBAAKnD,UAAU,YACb,yBAAKA,UAAU,uBACb,yBAAKA,UAAU,eAAf,wBADF,IAC2DtC,GAE3D,yBAAKsC,UAAU,eAAf,gBAA2CwC,OAAOC,KAAKzF,EAAMb,OAAOqB,QAEpE,yBAAKwC,UAAU,eACb,yBAAKA,UAAU,qBAAf,qBACCkD,ICrIME,MAhBf,WACE,OACE,kBAACpE,EAAD,KACE,yBAAKgB,UAAU,cACb,yBAAKA,UAAU,eACZhE,EAAiBiE,KAAI,SAAC1D,GAAD,OACpB,kBAACkF,EAAD,CAAY7E,KAAML,QAGtB,kBAACwF,EAAD,OAEF,kBAAC,IAAD,CAAc/B,UAAU,UAAUqD,OAAO,QAAQC,MAAM,EAAMC,WAAW,MCd9EC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,W","file":"static/js/main.f8224f97.chunk.js","sourcesContent":["const ascensionData = require('./ascension.json');\r\n\r\nexport const EMBODIMENT_NAMES = ['force', 'entropy', 'form', 'inertia', 'life'];\r\nexport const CLUSTERS = { root: { nodes: {}, rewards: {} } };\r\nexport const EMBODIMENTS = {};\r\n\r\nEMBODIMENT_NAMES.forEach(\r\n  (embodiment) =>\r\n    (CLUSTERS.root.nodes[embodiment] = {\r\n      description: `+1 ${embodiment[0].toUpperCase()}${embodiment.substring(1)}.`,\r\n    })\r\n);\r\nEMBODIMENT_NAMES.forEach((embodiment) => (EMBODIMENTS[embodiment] = []));\r\n\r\nfor (let cluster of ascensionData) {\r\n  CLUSTERS[cluster.name] = cluster;\r\n  EMBODIMENTS[cluster.embodiment].push(cluster);\r\n}\r\n","import { CLUSTERS } from '../dataset';\r\n\r\nexport function isNodeSelected(node, state) {\r\n  return `${node.cluster}.${node.index}` in state.nodes;\r\n}\r\n\r\nexport function isNodeSelectable(node, state) {\r\n  if (node.cluster == 'root') return true;\r\n\r\n  const cluster = CLUSTERS[node.cluster];\r\n  const clusterAvailable = isClusterAvailable(cluster, state);\r\n  return (\r\n    (clusterAvailable && node.index == 0) ||\r\n    (clusterAvailable && isNodeSelected({ ...node, index: node.index - 1 }, state))\r\n  );\r\n}\r\n\r\nexport function isNodeDeselectable(node, state) {\r\n  return !isNodeSelected({ ...node, index: node.index + 1 }, state);\r\n}\r\n\r\nexport function getNodeId(node) {\r\n  return `${node.cluster}.${node.index}`;\r\n}\r\n\r\nexport function getSelectedSubnode(node, state) {\r\n  return state.nodes[getNodeId(node)];\r\n}\r\n\r\nexport function isClusterComplete(cluster, state) {\r\n  for (let i = 0; i < cluster.nodes.length; i++) {\r\n    if (!isNodeSelected({ cluster: cluster.name, index: i }, state)) return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function isClusterAvailable(cluster, state) {\r\n  for (let embodiment in cluster.requirements) {\r\n    if (state.points[embodiment] < cluster.requirements[embodiment]) return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function isValidState({ nodes, points }) {\r\n  let clusterNames = {};\r\n  for (let nodeId in nodes) {\r\n    clusterNames[nodeId.split('.')[0]] = true;\r\n  }\r\n\r\n  for (let clusterName in clusterNames) {\r\n    const cluster = CLUSTERS[clusterName];\r\n    for (let embodiment in cluster.requirements) {\r\n      if (points[embodiment] < cluster.requirements[embodiment]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n","import React, { useReducer } from 'react';\r\nimport { CLUSTERS } from '../dataset';\r\nimport {\r\n  isNodeSelectable,\r\n  isClusterComplete,\r\n  isNodeDeselectable,\r\n  isValidState,\r\n  getNodeId,\r\n} from './util';\r\n\r\nexport const CalculatorContext = React.createContext(null);\r\n\r\nconst BONUS_REGEX = /\\+1 (Force|Entropy|Form|Inertia|Life)./;\r\n\r\nfunction getBonusPoint({ cluster, index, subnode }) {\r\n  const node = CLUSTERS[cluster].nodes[index];\r\n\r\n  let bonusPoint = null;\r\n  let match = node.description.match(BONUS_REGEX);\r\n  if (subnode != -1 && !match) match = node.subnodes[subnode].match(BONUS_REGEX);\r\n  if (match) bonusPoint = match[1].toLowerCase();\r\n\r\n  return bonusPoint;\r\n}\r\n\r\nfunction reducer(state, { type, node }) {\r\n  const nodeId = getNodeId(node);\r\n  const cluster = CLUSTERS[node.cluster];\r\n\r\n  const newNodes = { ...state.nodes };\r\n  const newPoints = { ...state.points };\r\n\r\n  const bonusPoint = getBonusPoint(node);\r\n\r\n  switch (type) {\r\n    case 'select':\r\n      if (!isNodeSelectable(node, state)) break;\r\n      newNodes[nodeId] = node.subnode;\r\n\r\n      if (isClusterComplete(cluster, { ...state, nodes: newNodes })) {\r\n        for (let embodiment in cluster.rewards) {\r\n          newPoints[embodiment] += cluster.rewards[embodiment];\r\n        }\r\n      }\r\n\r\n      if (bonusPoint) newPoints[bonusPoint] += 1;\r\n\r\n      break;\r\n\r\n    case 'deselect':\r\n      if (!isNodeDeselectable(node, state)) break;\r\n\r\n      if (cluster && isClusterComplete(cluster, { ...state, nodes: newNodes })) {\r\n        for (let embodiment in cluster.rewards) {\r\n          newPoints[embodiment] -= cluster.rewards[embodiment];\r\n        }\r\n      }\r\n\r\n      if (bonusPoint) newPoints[bonusPoint] -= 1;\r\n\r\n      delete newNodes[nodeId];\r\n      break;\r\n\r\n    case 'reselect':\r\n      const prevBonusPoint = getBonusPoint({ ...node, subnode: state.nodes[nodeId] });\r\n      if (bonusPoint) newPoints[bonusPoint] += 1;\r\n      if (prevBonusPoint) newPoints[prevBonusPoint] -= 1;\r\n\r\n      newNodes[nodeId] = node.subnode;\r\n      break;\r\n  }\r\n\r\n  if (!isValidState({ nodes: newNodes, points: newPoints })) return state;\r\n  return { nodes: newNodes, points: newPoints };\r\n}\r\n\r\nexport function CalculatorProvider({ children }) {\r\n  const [state, dispatch] = useReducer(reducer, {\r\n    nodes: {},\r\n    points: {\r\n      force: 0,\r\n      entropy: 0,\r\n      form: 0,\r\n      inertia: 0,\r\n      life: 0,\r\n    },\r\n  });\r\n\r\n  return (\r\n    <CalculatorContext.Provider value={{ state, dispatch }}>{children}</CalculatorContext.Provider>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ReactDOMServer from 'react-dom/server';\r\nimport { CLUSTERS } from '../dataset';\r\n\r\nexport function NodeTooltip({ cluster, index }) {\r\n  const node = CLUSTERS[cluster].nodes[index];\r\n  const subnodes = node.subnodes;\r\n\r\n  const descriptionLines = node.description.replace(/»/g, '').split('\\n');\r\n  const subnodeDescriptions = [];\r\n\r\n  if (subnodes && subnodes.length) {\r\n    for (let i = 0; i < subnodes.length; i++) {\r\n      const subnodeLines = subnodes[i].replace(/»/g, '').split('\\n');\r\n\r\n      subnodeDescriptions.push(\r\n        <div className=\"subnode-description\">\r\n          <span className=\"subnode-number\">{i + 1})</span>\r\n          <span className=\"subnode-lines\">\r\n            {subnodeLines.map((line) => (\r\n              <span className=\"description-line\">{line}</span>\r\n            ))}\r\n          </span>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"node-description\">\r\n        {descriptionLines.map((line) => (\r\n          <span className=\"description-line\">{line}</span>\r\n        ))}\r\n      </div>\r\n      {subnodeDescriptions}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function tooltipHtml({ cluster, index }) {\r\n  return ReactDOMServer.renderToStaticMarkup(<NodeTooltip cluster={cluster} index={index} />);\r\n}\r\n","import React, { useContext } from 'react';\r\nimport classNames from 'classnames';\r\nimport { CalculatorContext } from '../state/CalculatorContext';\r\nimport { isNodeSelected, isNodeSelectable, getSelectedSubnode } from '../state/util';\r\nimport { CLUSTERS } from '../dataset';\r\nimport { tooltipHtml } from './NodeTooltip';\r\n\r\nexport function Node({ cluster, index }) {\r\n  const { state, dispatch } = useContext(CalculatorContext);\r\n\r\n  const nodeInfo = { cluster, index };\r\n  const isSelected = isNodeSelected(nodeInfo, state);\r\n  const isSelectable = !isSelected && isNodeSelectable(nodeInfo, state);\r\n  const selectedSubnode = isSelected && getSelectedSubnode(nodeInfo, state);\r\n\r\n  const node = CLUSTERS[cluster].nodes[index];\r\n\r\n  function handler(subnode) {\r\n    if (!isSelected) {\r\n      dispatch({\r\n        type: 'select',\r\n        node: { subnode, ...nodeInfo },\r\n      });\r\n    } else if (subnode != selectedSubnode) {\r\n      dispatch({\r\n        type: 'reselect',\r\n        node: { subnode, ...nodeInfo },\r\n      });\r\n    } else {\r\n      dispatch({\r\n        type: 'deselect',\r\n        node: { subnode, ...nodeInfo },\r\n      });\r\n    }\r\n  }\r\n\r\n  if (node.subnodes && node.subnodes.length) {\r\n    const subnodeElements = [];\r\n    for (let i = 0; i < node.subnodes.length; i++) {\r\n      subnodeElements.push(\r\n        <div\r\n          className={classNames('subnode', { selected: isSelected && selectedSubnode == i })}\r\n          onClick={() => handler(i)}\r\n        >\r\n          {i + 1}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div\r\n        data-tip={tooltipHtml(nodeInfo)}\r\n        className={classNames('node subnodes', { selected: isSelected, selectable: isSelectable })}\r\n      >\r\n        {subnodeElements}\r\n      </div>\r\n    );\r\n  } else {\r\n    return (\r\n      <div\r\n        data-tip={tooltipHtml(nodeInfo)}\r\n        className={classNames('node', { selected: isSelected, selectable: isSelectable })}\r\n        onClick={() => handler(-1)}\r\n      ></div>\r\n    );\r\n  }\r\n}\r\n","import React, { useContext } from 'react';\r\nimport classNames from 'classnames';\r\nimport { Node } from './Node';\r\nimport { CLUSTERS } from '../dataset';\r\nimport { CalculatorContext } from '../state/CalculatorContext';\r\nimport { isClusterAvailable, isClusterComplete } from '../state/util';\r\n\r\nexport function Cluster({ name }) {\r\n  const { state } = useContext(CalculatorContext);\r\n\r\n  const cluster = CLUSTERS[name];\r\n  const isAvailable = isClusterAvailable(cluster, state);\r\n  const isComplete = isAvailable && isClusterComplete(cluster, state);\r\n\r\n  const requirements = [];\r\n  for (let embodiment in cluster.requirements) {\r\n    requirements.push(\r\n      <div className={`point ${embodiment}`}>{cluster.requirements[embodiment]}</div>\r\n    );\r\n  }\r\n\r\n  const rewards = [];\r\n  for (let embodiment in cluster.rewards) {\r\n    rewards.push(<div className={`point ${embodiment}`}>{cluster.rewards[embodiment]}</div>);\r\n  }\r\n\r\n  const nodes = [];\r\n  for (let i = 0; i < cluster.nodes.length; i++) {\r\n    nodes.push(<Node cluster={name} index={i} />);\r\n  }\r\n\r\n  return (\r\n    <div className={classNames('cluster', { available: isAvailable, complete: isComplete })}>\r\n      <div className=\"requirements points\">{requirements}</div>\r\n      <div className=\"cluster-name\"> {name} </div>\r\n      <div className=\"rewards points\">{rewards}</div>\r\n      <div className=\"nodes\">{nodes}</div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Node } from './Node';\r\nimport { Cluster } from './Cluster';\r\nimport { EMBODIMENTS } from '../dataset';\r\n\r\nexport function Embodiment({ name }) {\r\n  const clusters = [];\r\n  const embodiment = EMBODIMENTS[name];\r\n\r\n  for (let cluster of embodiment) {\r\n    clusters.push(<Cluster name={cluster.name} />);\r\n  }\r\n\r\n  return (\r\n    <div className=\"embodiment\">\r\n      <div className=\"embodiment-name\">\r\n        {name}\r\n        <Node cluster=\"root\" index={name} />\r\n      </div>\r\n      <div className=\"clusters\">{clusters}</div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useContext } from 'react';\nimport { CalculatorContext } from '../state/CalculatorContext';\nimport { EMBODIMENT_NAMES, CLUSTERS } from '../dataset';\n\nconst VALUE_MODIFIER_REGEX = /^\\+([\\d.]+)(.*)/;\n\nconst categories = [\n  {\n    header: 'Attributes',\n    regex: /^\\+\\d+(% invested)? (strength|constitution|power|finesse|wits|memory)\\./,\n  },\n  {\n    header: 'Skills',\n    regex: /^\\+\\d+ (ranged|single-handed|two-handed|leadership|perseverance|retribution|aerotheurge|geomancer|huntsman|hydrosophist|necromancer|polymorph|pyrokinetic|scoundrel|summoning|warfare|sourcery)\\./,\n  },\n  {\n    header: 'Stats',\n    regex: /^\\+[\\d.]+%? (initiative|critical chance|accuracy|damage|movement speed|lifesteal|maximum vitality|dodge chance)\\./,\n  },\n  {\n    header: 'Resistances',\n    regex: /^\\+\\d+% ((water|fire|air|earth|poison|physical|piercing) resistance|to elemental resistances)\\./,\n  },\n  {\n    header: 'Summons',\n    regex: /^\\+[\\d.]+%? summon \\w+( \\w+)?\\./,\n  },\n  {\n    header: 'Embodiments',\n    regex: /^\\+\\d+ (force|entropy|form|inertia|life)\\./,\n  },\n  {\n    header: 'Predator',\n    regex: /predator/,\n  },\n  {\n    header: 'Voracity',\n    regex: /voracity/,\n  },\n  {\n    header: 'Elementalist',\n    regex: /elementalist/,\n  },\n];\n\nfunction collectModifiers(state) {\n  const valueModifiers = {};\n  const textModifiers = [];\n\n  function addModifier(line) {\n    line\n      .split('\\n» ')\n      .map((s) => s.trim())\n      .forEach((modifier) => {\n        let match = modifier.match(VALUE_MODIFIER_REGEX);\n        if (match) {\n          const description = match[2];\n          const value = Number(match[1]);\n          valueModifiers[description] = (valueModifiers[description] || 0) + value;\n        } else {\n          textModifiers.push(modifier);\n        }\n      });\n  }\n\n  for (let nodeId in state.nodes) {\n    let [cluster, index] = nodeId.split('.');\n\n    const node = CLUSTERS[cluster].nodes[index];\n    const subnode = state.nodes[nodeId];\n\n    const modifier = node.description.trim();\n\n    if (modifier) addModifier(modifier);\n    if (subnode != -1) {\n      addModifier(node.subnodes[subnode]);\n    }\n  }\n\n  const modifiers = [];\n\n  for (let description of Object.keys(valueModifiers)) {\n    let value = valueModifiers[description];\n    modifiers.push(`+${Math.round(value * 10) / 10}${description}`);\n  }\n\n  modifiers.push(...textModifiers);\n\n  return modifiers;\n}\n\nexport function Overview() {\n  const { state } = useContext(CalculatorContext);\n\n  const points = [];\n  for (let embodiment of EMBODIMENT_NAMES) {\n    points.push(<div className={`point ${embodiment}`}>{state.points[embodiment]}</div>);\n  }\n\n  const modifiers = collectModifiers(state);\n  let modifiersByCategory = categories.map((c) => []);\n  const otherModifiers = [];\n\n  for (let modifier of modifiers) {\n    let hasCategory = false;\n\n    for (let i = 0; i < categories.length; i++) {\n      const category = categories[i];\n\n      if (modifier.toLowerCase().match(category.regex)) {\n        hasCategory = true;\n        modifiersByCategory[i].push(modifier);\n        break;\n      }\n    }\n\n    if (!hasCategory) {\n      otherModifiers.push(modifier);\n    }\n  }\n\n  const categoryElements = [];\n  for (let i = 0; i < categories.length; i++) {\n    const category = categories[i];\n\n    if (modifiersByCategory[i].length) {\n      categoryElements.push(\n        <div className=\"category\">\n          <div className=\"category-header\">{category.header}:</div>\n          {modifiersByCategory[i].map((m) => (\n            <div>{m}</div>\n          ))}\n        </div>\n      );\n    }\n  }\n\n  if (otherModifiers.length) {\n    categoryElements.push(\n      <div className=\"category\">\n        <div className=\"category-header\">Other bonuses:</div>\n        {otherModifiers.map((m) => (\n          <div>{m}</div>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"overview\">\n      <div className=\"total-points points\">\n        <div className=\"points-name\">Available Ascension:</div> {points}\n      </div>\n      <div className=\"points-used\">Points used: {Object.keys(state.nodes).length}</div>\n\n      <div className=\"description\">\n        <div className=\"description-title\">Bonuses overview:</div>\n        {categoryElements}\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport './App.css';\nimport ReactTooltip from 'react-tooltip';\nimport { CalculatorProvider } from './state/CalculatorContext';\nimport { EMBODIMENT_NAMES } from './dataset';\nimport { Embodiment } from './components/Embodiment';\nimport { Overview } from './components/Overview';\n\nfunction App() {\n  return (\n    <CalculatorProvider>\n      <div className=\"calculator\">\n        <div className=\"embodiments\">\n          {EMBODIMENT_NAMES.map((embodiment) => (\n            <Embodiment name={embodiment} />\n          ))}\n        </div>\n        <Overview />\n      </div>\n      <ReactTooltip className=\"tooltip\" effect=\"solid\" html={true} multiline={true} />\n    </CalculatorProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}